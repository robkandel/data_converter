var parse_csv_json=(function(){var a;var b={init:function(d,c){var g=new RegExp("[^,]","gi");var h=d.replace(g,"").length;g=new RegExp("[^\t]","gi");var i=d.replace(g,"").length;var f="\n";var e=",";if(i>h){e="\t"}g=new RegExp("^"+f+"+","gi");d=d.replace(g,"");g=new RegExp(f+"+$","gi");d=d.replace(g,"");return b.parse_csv(d,",",c)},parse_csv:function(e,d,k){var j=new RegExp(("(\\"+d+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+d+"\\r\\n]*))"),"gi");var f=[[]];var i=null;while(i=j.exec(e)){var h=i[1];if(h.length&&h!=d){f.push([])}if(i[2]){var g=i[2].replace(new RegExp('""',"g"),'"')}else{var g=i[3]}f[f.length-1].push(g)}return b.remove_line_breaks(f,k)},remove_line_breaks:function(e,c){var j=-1;var g=-1;for(var f=0;f<e.length;f++){for(var h=0;h<e[f].length;h++){e[f][h]=e[f][h].replace(/\t/g," ").replace(/\n/g," ").replace(/\r/g," ");if(f==0){if(e[f][h].toLowerCase()=="latitude"||e[f][h].toLowerCase()=="lat"||e[f][h].toLowerCase()=="lat."){j=h}if(e[f][h].toLowerCase()=="longitude"||e[f][h].toLowerCase()=="lon"||e[f][h].toLowerCase()=="lng"||e[f][h].toLowerCase()=="lon."||e[f][h].toLowerCase()=="lng."||e[f][h].toLowerCase()=="long"||e[f][h].toLowerCase()=="long."){g=h}}}}if(j!=-1&&g!=-1){jQuery("li[data-role='option_4']").removeClass("optionButtonNotActive");jQuery("li[data-role='option_5']").removeClass("optionButtonNotActive")}else{jQuery("li[data-role='option_4']").addClass("optionButtonNotActive");jQuery("li[data-role='option_5']").addClass("optionButtonNotActive")}if(c=="object"){a=b.convert_to_json(e)}else{if(c=="array"){a=e}else{if(c=="table"){a=b.convert_to_table(e)}else{if(c=="xml"){a=b.convert_to_xml(e)}else{if(c=="kml"){a=b.convert_to_geojson(e,j,g,false)}else{if(c=="geojson"){a=b.convert_to_geojson(e,j,g,true)}}}}}}return a},convert_to_json:function(f){var e=[];for(var g=1;g<f.length;g++){var h={};for(var d in f[g]){h[jQuery.trim(f[0][d])]=f[g][d]}e.push(h)}return e},convert_to_table:function(e){var c='<table class="dataConverterTable">\n\t<thead>';for(var f=0;f<e.length;f++){if(f==1){c+="\n\t</thead>\n\t<tbody>"}if(f!=0){if(f%2){c+='\n\t\t<tr class="rowEven rowIndex'+f+'">'}else{c+='\n\t\t<tr class="rowOdd rowIndex'+f+'">'}}else{c+="\n\t\t<tr>"}for(var g=0;g<e[f].length;g++){c+='\n\t\t\t<td class="cellIndex'+g+'">'+e[f][g]+"</td>"}c+="\n\t\t</tr>"}c+="\n\t</tbody>\n</table>";jQuery("#table_converter").html(c);return c},convert_to_xml:function(e){var g='<?xml version="1.0" encoding="UTF-8"?>\n<rows>';for(var f=1;f<e.length;f++){g+="\n\t<row>";for(var h=0;h<e[f].length;h++){var c=e[0][h];if(c==""){c="tag"+h}g+="\n\t\t<"+jQuery.trim(c.replace(/ /g,"_").replace(/\W+/g,""))+">"+e[f][h]+"</"+jQuery.trim(c.replace(/ /g,"_").replace(/\W+/g,""))+">"}g+="\n\t</row>"}g+="\n</rows>";jQuery("#table_converter").html(g);return g},convert_to_geojson:function(j,f,n,l){var h='<?xml version="1.0" encoding="UTF-8"?><kml xmlns="http://www.opengis.net/kml/2.2"><Document>';for(var k=1;k<j.length;k++){h+="<Placemark>";h+="<Point><coordinates>"+j[k][parseFloat(n)]+","+j[k][parseFloat(f)]+",0</coordinates></Point>";for(var m=0;m<j[k].length;m++){var g=j[0][m];if(g==""){g="tag"+m}if(m==0){h+="<ExtendedData>"}if(m!=parseFloat(f)&&m!=parseFloat(n)){h+="<"+jQuery.trim(g.replace(/ /g,"_").replace(/\W+/g,""))+">"+j[k][m].replace(/&/g,"&amp;").replace(/</g,"lt;").replace(/>/g,"gt;")+"</"+jQuery.trim(g.replace(/ /g,"_").replace(/\W+/g,""))+">"}if(m==j[k].length-1){h+="</ExtendedData>"}}h+="</Placemark>"}h+="</Document></kml>";if(l){return toGeoJSON.kml(jQuery.parseXML(h))}else{return jQuery("#table_converter").html(h)}}};return b})();